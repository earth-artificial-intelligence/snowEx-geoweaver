[{
  "history_id" : "6IOJTZ4oMXiK",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/snowx/\"\n\npolygon_filepath = str(f'{homedir}/snowx/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.28812429263995,38.9376560601842,-107.76084551933717,38.93217823859049,-107.75873173540937,39.16610050975101,-108.25202140957613,39.169195040825244,-108.28812429263995,38.9376560601842\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-07-10T21:52:56.600Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.28812429263995%2C38.9376560601842%2C-107.76084551933717%2C38.93217823859049%2C-107.75873173540937%2C39.16610050975101%2C-108.25202140957613%2C39.169195040825244%2C-108.28812429263995%2C38.9376560601842&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1657489975084,
  "history_end_time" : 1657489976774,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : null,
  "indicator" : "Done"
},{
  "history_id" : "zAdz7WiwEY5p",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/snowx/\"\n\npolygon_filepath = str(f'{homedir}/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Traceback (most recent call last):\n  File \"fiona/_shim.pyx\", line 83, in fiona._shim.gdal_open_vector\n  File \"fiona/_err.pyx\", line 291, in fiona._err.exc_wrap_pointer\nfiona._err.CPLE_OpenFailedError: /Users/uhhmed/nsidc-polygon.json: No such file or directory\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\n  File \"snowex_nsidc_search.py\", line 29, in <module>\n    gdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n  File \"/opt/anaconda3/lib/python3.8/site-packages/geopandas/io/file.py\", line 201, in _read_file\n    with reader(path_or_bytes, **kwargs) as features:\n  File \"/opt/anaconda3/lib/python3.8/site-packages/fiona/env.py\", line 408, in wrapper\n    return f(*args, **kwargs)\n  File \"/opt/anaconda3/lib/python3.8/site-packages/fiona/__init__.py\", line 264, in open\n    c = Collection(path, mode, driver=driver, encoding=encoding,\n  File \"/opt/anaconda3/lib/python3.8/site-packages/fiona/collection.py\", line 162, in __init__\n    self.session.start(self, **kwargs)\n  File \"fiona/ogrext.pyx\", line 540, in fiona.ogrext.Session.start\n  File \"fiona/_shim.pyx\", line 90, in fiona._shim.gdal_open_vector\nfiona.errors.DriverError: /Users/uhhmed/nsidc-polygon.json: No such file or directory\n",
  "history_begin_time" : 1657489917418,
  "history_end_time" : 1657489923852,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : null,
  "indicator" : "Failed"
},{
  "history_id" : "42qp8o3trhz",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.2352445938561,38.98556907427165,-107.85284607930835,38.978765032966244,-107.85494925720668,39.10596902171742,-108.22772795408136,39.11294532581687,-108.2352445938561,38.98556907427165\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-01-19T17:34:03.946Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.2352445938561%2C38.98556907427165%2C-107.85284607930835%2C38.978765032966244%2C-107.85494925720668%2C39.10596902171742%2C-108.22772795408136%2C39.11294532581687%2C-108.2352445938561%2C38.98556907427165&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1642613643181,
  "history_end_time" : 1656425770236,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Stopped"
},{
  "history_id" : "zz54lf7vxs9",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.2352445938561,38.98556907427165,-107.85284607930835,38.978765032966244,-107.85494925720668,39.10596902171742,-108.22772795408136,39.11294532581687,-108.2352445938561,38.98556907427165\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-01-19T16:16:47.043Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.2352445938561%2C38.98556907427165%2C-107.85284607930835%2C38.978765032966244%2C-107.85494925720668%2C39.10596902171742%2C-108.22772795408136%2C39.11294532581687%2C-108.2352445938561%2C38.98556907427165&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1642609005794,
  "history_end_time" : 1642609007115,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "3w2dwko3rbf",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642608940360,
  "history_end_time" : 1642608940402,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "1gmfx0rbw2b",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642608916091,
  "history_end_time" : 1642608916165,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "6ep06o0d7ve",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.2352445938561,38.98556907427165,-107.85284607930835,38.978765032966244,-107.85494925720668,39.10596902171742,-108.22772795408136,39.11294532581687,-108.2352445938561,38.98556907427165\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-01-19T16:09:56.936Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.2352445938561%2C38.98556907427165%2C-107.85284607930835%2C38.978765032966244%2C-107.85494925720668%2C39.10596902171742%2C-108.22772795408136%2C39.11294532581687%2C-108.2352445938561%2C38.98556907427165&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1642608594579,
  "history_end_time" : 1642608596709,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "k3k3sdvj7rk",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "  File \"snowex_nsidc_search.py\", line 25\n    datadir = f\"{homedir}/Documents/data/\"\n                                         ^\nSyntaxError: invalid syntax\n",
  "history_begin_time" : 1642607493758,
  "history_end_time" : 1642607494136,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "47grogdy3nq",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642607461355,
  "history_end_time" : 1642607461430,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "z127erk5vqg",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642606600639,
  "history_end_time" : 1642606600886,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "tkvxn5aivr3",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642606578121,
  "history_end_time" : 1642606578266,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "dnd019ty9am",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642606523427,
  "history_end_time" : 1642606523553,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "18v2fo2p6os",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642606499732,
  "history_end_time" : 1642606499849,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "zmd9u56x8fd",
  "history_input" : null,
  "history_output" : "Authentication Failed. Wrong Password.",
  "history_begin_time" : 1642606452391,
  "history_end_time" : 1642606452529,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Failed"
},{
  "history_id" : "bhrzrmkcdso",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.2352445938561,38.98556907427165,-107.85284607930835,38.978765032966244,-107.85494925720668,39.10596902171742,-108.22772795408136,39.11294532581687,-108.2352445938561,38.98556907427165\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-01-19T09:22:19.671Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.2352445938561%2C38.98556907427165%2C-107.85284607930835%2C38.978765032966244%2C-107.85494925720668%2C39.10596902171742%2C-108.22772795408136%2C39.11294532581687%2C-108.2352445938561%2C38.98556907427165&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1642584136660,
  "history_end_time" : 1642584139765,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "qwu8wvyot64",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.2352445938561,38.98556907427165,-107.85284607930835,38.978765032966244,-107.85494925720668,39.10596902171742,-108.22772795408136,39.11294532581687,-108.2352445938561,38.98556907427165\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-01-19T08:09:09.513Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.2352445938561%2C38.98556907427165%2C-107.85284607930835%2C38.978765032966244%2C-107.85494925720668%2C39.10596902171742%2C-108.22772795408136%2C39.11294532581687%2C-108.2352445938561%2C38.98556907427165&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1642579748596,
  "history_end_time" : 1642579749630,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Done"
},{
  "history_id" : "wb01m2s9w5c",
  "history_input" : "# Write first python in Geoweaver\nimport os\nimport geopandas as gpd\nfrom shapely.geometry import Polygon, mapping\nfrom shapely.geometry.polygon import orient\nimport pandas as pd \nimport requests\nimport json\nimport pprint\nimport getpass\nimport netrc\nfrom platform import system\nfrom getpass import getpass\nfrom urllib import request\nfrom http.cookiejar import CookieJar\nfrom os.path import join, expanduser\nimport requests\nfrom xml.etree import ElementTree as ET\nimport time\nimport zipfile\nimport io\nimport shutil\n\nhomedir = os.path.expanduser('~') \ndatadir = f\"{homedir}/Documents/data/\"\n\npolygon_filepath = str(f'{homedir}/Documents/data/nsidc-polygon.json') # Note: A shapefile or other vector-based spatial data format could be substituted here.\n\ngdf = gpd.read_file(polygon_filepath) #Return a GeoDataFrame object\n\n# Simplify polygon for complex shapes in order to pass a reasonable request length to CMR. The larger the tolerance value, the more simplified the polygon.\n# Orient counter-clockwise: CMR polygon points need to be provided in counter-clockwise order. The last point should match the first point to close the polygon.\npoly = orient(gdf.simplify(0.05, preserve_topology=False).loc[0],sign=1.0)\n\n#Format dictionary to polygon coordinate pairs for CMR polygon filtering\npolygon = ','.join([str(c) for xy in zip(*poly.exterior.coords.xy) for c in xy])\nprint('Polygon coordinates to be used in search:', polygon)\n\ntemporal = '2017-01-01T00:00:00Z,2017-12-31T23:59:59Z' # Set temporal range\n\nparam_dict = {\n    'short_name': 'SNEX17_GPR',\n    'version': '2',\n    'polygon': polygon,\n#     'bounding_box': bounding_box, #optional alternative to polygon search parameter; if using, remove or comment out polygon search parameter\n    'temporal':temporal,\n}\n\ndef search_granules(search_parameters, geojson=None, output_format=\"json\"):\n    \"\"\"\n    Performs a granule search with token authentication for restricted results\n    \n    :search_parameters: dictionary of CMR search parameters\n    :token: CMR token needed for restricted search\n    :geojson: filepath to GeoJSON file for spatial search\n    :output_format: select format for results https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html#supported-result-formats\n    \n    :returns: if hits is greater than 0, search results are returned in chosen output_format, otherwise returns None.\n    \"\"\"\n    search_url = \"https://cmr.earthdata.nasa.gov/search/granules\"\n\n    \n    if geojson:\n        files = {\"shapefile\": (geojson, open(geojson, \"r\"), \"application/geo+json\")}\n    else:\n        files = None\n    \n    \n    parameters = {\n        \"scroll\": \"true\",\n        \"page_size\": 100,\n    }\n    \n    try:\n        response = requests.post(f\"{search_url}.{output_format}\", params=parameters, data=search_parameters, files=files)\n        response.raise_for_status()\n    except HTTPError as http_err:\n        print(f\"HTTP Error: {http_error}\")\n    except Exception as err:\n        print(f\"Error: {err}\")\n    \n    hits = int(response.headers['CMR-Hits'])\n    if hits > 0:\n        print(f\"Found {hits} files\")\n        results = json.loads(response.content)\n        granules = []\n        granules.extend(results['feed']['entry'])\n        granule_sizes = [float(granule['granule_size']) for granule in granules]\n        print(f\"The total size of all files is {sum(granule_sizes):.2f} MB\")\n        return response.json()\n    else:\n        print(\"Found no hits\")\n        return\n\nprint(search_granules(param_dict))\n",
  "history_output" : "Polygon coordinates to be used in search: -108.2352445938561,38.98556907427165,-107.85284607930835,38.978765032966244,-107.85494925720668,39.10596902171742,-108.22772795408136,39.11294532581687,-108.2352445938561,38.98556907427165\nFound 3 files\nThe total size of all files is 209.20 MB\n{'feed': {'updated': '2022-01-19T08:08:09.321Z', 'id': 'https://cmr.earthdata.nasa.gov:443/search/granules.json?short_name=SNEX17_GPR&version=2&polygon=-108.2352445938561%2C38.98556907427165%2C-107.85284607930835%2C38.978765032966244%2C-107.85494925720668%2C39.10596902171742%2C-108.22772795408136%2C39.11294532581687%2C-108.2352445938561%2C38.98556907427165&temporal=2017-01-01T00%3A00%3A00Z%2C2017-12-31T23%3A59%3A59Z', 'title': 'ECHO granule metadata', 'entry': [{'producer_granule_id': 'SnowEx17_GPR_Version2_Week1.csv', 'time_start': '2017-02-08T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128516', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-10T23:59:59.000Z', 'id': 'G1657541380-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '57.3195', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.07092 39.02644 -108.13422 39.04032 -108.18504 39.0357 -108.2211 39.01719 -108.21534 38.99637 -108.18261 39.00562 -108.11049 39.02413 -108.06225 39.03338 -108.06213 39.02876 -108.08619 39.04264 -108.05301 39.05189 -108.05289 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.08/SnowEx17_GPR_Version2_Week1.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week2.csv', 'time_start': '2017-02-14T00:00:00.000Z', 'updated': '2019-11-20T14:19:39.156Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:167128520', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-17T23:59:59.000Z', 'id': 'G1657541238-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '85.516', 'browse_flag': False, 'polygons': [['39.10738 -107.88943 39.10738 -107.89539 39.0912 -107.95508 39.07271 -108.02372 39.0542 -108.09234 39.04264 -108.16078 39.0357 -108.2113 39.03338 -108.2113 39.0195 -108.20533 39.00099 -108.18454 39.00099 -108.12811 39.00099 -108.08653 39.02644 -108.02094 39.0357 -107.94938 39.02413 -107.93155 39.04726 -107.89867 39.08195 -107.85677 39.10507 -107.86257 39.10969 -107.88644 39.10738 -107.88943']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.14/SnowEx17_GPR_Version2_Week2.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}, {'producer_granule_id': 'SnowEx17_GPR_Version2_Week3.csv', 'time_start': '2017-02-21T00:00:00.000Z', 'updated': '2020-02-18T12:25:16.785Z', 'dataset_id': 'SnowEx17 Ground Penetrating Radar V002', 'data_center': 'NSIDC_ECS', 'title': 'SC:SNEX17_GPR.002:173252482', 'coordinate_system': 'GEODETIC', 'day_night_flag': 'UNSPECIFIED', 'time_end': '2017-02-25T23:59:59.000Z', 'id': 'G1694922459-NSIDC_ECS', 'original_format': 'ECHO10', 'granule_size': '66.3598', 'browse_flag': False, 'polygons': [['39.05189 -108.06789 39.04958 -108.06792 39.03107 -108.08616 39.0195 -108.15531 39.00331 -108.14352 39.00562 -108.11049 39.00562 -108.05349 39.01719 -108.05334 39.02876 -108.02919 39.0542 -108.05586 39.0542 -108.06786 39.05189 -108.06789']], 'collection_concept_id': 'C1655875737-NSIDC_ECS', 'online_access_flag': True, 'links': [{'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'type': 'text/plain', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv'}, {'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'type': 'text/xml', 'title': '(METADATA)', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/DP1/SNOWEX/SNEX17_GPR.002/2017.02.21/SnowEx17_GPR_Version2_Week3.csv.xml'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://n5eil01u.ecs.nsidc.org/SNOWEX/SNEX17_GPR.002/'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://search.earthdata.nasa.gov/search/granules?p=C1655875737-NSIDC_ECS&q=SNEX17_GPR&m=29.76382409255042!-108.823974609375!4!1!0!0%2C2&tl=1558474061!4!!'}, {'inherited': True, 'length': '0.0KB', 'rel': 'http://esipfed.org/ns/fedsearch/1.1/data#', 'hreflang': 'en-US', 'href': 'https://nsidc.org/data/data-access-tool/SNEX17_GPR/versions/2/'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/metadata#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}, {'inherited': True, 'rel': 'http://esipfed.org/ns/fedsearch/1.1/documentation#', 'hreflang': 'en-US', 'href': 'https://doi.org/10.5067/G21LGCNLFSC5'}]}]}}\n",
  "history_begin_time" : 1642579687498,
  "history_end_time" : 1642579689465,
  "history_notes" : null,
  "history_process" : "4fh28s",
  "host_id" : "100001",
  "indicator" : "Done"
},]
